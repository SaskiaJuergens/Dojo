<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabellenzeile hinzufügen</title>
    <!--<link rel="stylesheet" href="css/StyleSheet.css" />-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>

<body>
    <div class="container mt-3">
        <table class="table table-dark" id="TeilenhmerTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Vorname</th>
                    <th>Geburstdatum</th>
                    <th>Alter <button>!</button></th> <!-- Kind (bis 13), Jugendlich (14-18), Erwachsen (ab18 - dann auch erst schwarz Gurt erlaubt)-->
                    <th>Graduierung</th> <!--Mokuroku (Weiß)  (木録) - Grundstufe
                                            Shoden (Gelb)  (初伝) - Erste Stufe
                                            Chuden (Orange)  (中伝) - Mittelstufe
                                            Okuden (Grün) (奥伝) - Innere Stufe
                                            Menkyo (Schwarz)  (免許) - Meisterstufe-->
                    <th>Geschlecht</th> <!--Drop Down: Weiblich, Männlich, Nonbinär-->
                    <th>Nationalität</th>
                    <th>Verein</th>
                    <th>Schnellbogenschießen</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="tbody1">
                <!-- Placeholder for dynamic data -->
            </tbody>
        </table>
    </div>

    <script type="module">
//-------- Filling Tabelle -------->
        var Nummer = 0;
        var tbody = document.getElementById('tbody1');

        function AddTeilnehmer(name,vorname,data,age,rank,sex,nation,verein){
            let trow = document.createElement("tr");
            let td1 = document.createElement("td");
            let td2 = document.createElement("td");
            let td3 = document.createElement("td");
            let td4 = document.createElement("td");
            let td5 = document.createElement("td");
            let td6 = document.createElement("td");
            let td7 = document.createElement("td");
            let td8 = document.createElement("td");
            let td9 = document.createElement("td");

            td1.innerHTML= name;
            td2.innerHTML= vorname;
            td3.innerHTML= data;
            td4.innerHTML= age;
            td5.innerHTML= rank;
            td6.innerHTML= sex;
            td7.innerHTML= nation;
            td8.innerHTML= verein;

            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
            trow.appendChild(td5);
            trow.appendChild(td6);
            trow.appendChild(td7);
            trow.appendChild(td8);
            tbody.appendChild(trow);
        }

        function AddAllTeilnehmer(Teilnehmer) {
            Nummer = 0;
            tbody.innerHTML = "";
            Teilnehmer.forEach(element => {
                AddTeilnehmer(
                    element.Name,
                    element.Vorname,
                    element.Geburstdatum,
                    element.Alter,
                    element.Graduierung,
                    element.Sex,
                    element.Nationalität,
                    element.Verein
                );
            });
        }


//-------------Firebase DB Conection ----------->
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA8AWwq9SWpTjLwxzVaVKuo6HcVdfH5FhU",
            authDomain: "dojo-website-d7f0c.firebaseapp.com",
            databaseURL: "https://dojo-website-d7f0c-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "dojo-website-d7f0c",
            storageBucket: "dojo-website-d7f0c.appspot.com",
            messagingSenderId: "157008216879",
            appId: "1:157008216879:web:461d14ed280ed2a6ab17da"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        import{getDatabase, ref, child, onValue, get}
        from "https://www.gstatic.com/firebasejs/10.10.0/firebase-database.js";
        const db = getDatabase();

//-------------Getting all Data ----------->
        function GetAllDataOnce(){
            const dbRef = ref(db);

            get(child(dbRef, "Tabelle 2024/Teilnehmer"))
            .then((snapshot)=>{
                var teilnehmer = [];
                snapshot.forEach(childSnapshot => {
                    teilnehmer.push(childSnapshot.val());
                });

                AddAllTeilnehmer(teilnehmer);
            })
        }

        function GetAllDataRealTime(){
            const dbRef = ref(db, "Tabelle 2024/Teilnehmer");

            onValue(dbRef,(snapshot)=>{
                var teilnehmer = [];
                snapshot.forEach(childSnapshot => {
                    teilnehmer.push(childSnapshot.val());
                });
                AddAllTeilnehmer(teilnehmer);
            })
        }

        window.onload = GetAllDataRealTime;

//-------------Teilnehmer hinzufügen---------->
    </script>
</body>
</html>